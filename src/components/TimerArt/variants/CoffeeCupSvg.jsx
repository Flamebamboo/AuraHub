import React, { useEffect } from 'react';
import Svg, { Path } from 'react-native-svg';
import Animated, { useAnimatedProps, withTiming, useSharedValue } from 'react-native-reanimated';

// we are creating a custom animatable components with Animated Object
//
const AnimatedPath = Animated.createAnimatedComponent(Path);

const CoffeeCupSvg = ({ progress = 0 }) => {
  //useSharedValue lets you define shared values in your components
  const fillProgress = useSharedValue(1);

  useEffect(() => {
    //when using useSharedValue, values MUST be acess & modified through .value property

    //withTiming is a animation function used to animate progress
    //TODO: EXPLORE config
    fillProgress.value = withTiming(progress, {
      duration: 1000,
    });
  }, [progress]);

  // the fill Pattern for the coffee cup from svg converter
  const fillPath =
    'M26 73h40 M25 72h42 M24 71h44 M24 70h44 M24 69h44 M24 68h44 M24 67h44 M24 66h44 M24 65h44 M24 64h44 M24 63h44 M24 62h45 M24 61h45 M24 60h45 M24 59h45 M24 58h45 M24 57h45 M24 56h45 M24 55h45 M24 54h45 M24 53h45 M24 52h45 M24 51h45 M24 50h45 M24 49h45 M24 48h45 M24 47h45 M24 46h45 M24 45h45 M24 44h45 M24 43h45 M24 42h45 M24 41h45 M24 40h45 M24 39h45 M24 38h45 M24 37h45 M24 36h45 M24 35h45 M24 34h45 M24 33h45 M24 32h45 M24 31h45 M25 30h44 M26 29h43';
  //useAnimatedProps is a hook that updates everytime the animated value changes in this scenario it is the  fillProgress
  const animatedProps = useAnimatedProps(() => {
    // in SVG path, the M command stands for "move to" by splitting on M
    // it allows us to break down each path making it easier to animate
    const lines = fillPath.split('M');
    const totalLines = lines.length;
    const linesToShow = Math.floor(totalLines * (1 - fillProgress.value));

    //
    const visiblePath = lines
      .slice(0, linesToShow)
      .map((line, index) => (index === 0 ? line : 'M' + line))
      .join('');

    return {
      d: visiblePath || '', // Use empty string if no lines should be shown
    };
  });

  return (
    <Svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 -0.5 100 100"
      shapeRendering="crispEdges"
      style={{ width: '100%', height: '100%' }}
    >
      <Path
        stroke="#241527"
        d="M19 23h4M73 23h3M18 24h1M23 24h50M76 24h1M17 25h1M77 25h1M17 26h1M77 26h1M17 27h1M77 27h1M83 27h5M17 28h1M25 28h44M77 28h1M81 28h2M88 28h1M17 29h1M25 29h1M69 29h1M77 29h1M79 29h2M89 29h1M17 30h1M24 30h1M69 30h1M77 30h2M90 30h1M17 31h1M23 31h1M69 31h1M77 31h1M90 31h1M17 32h1M23 32h1M69 32h1M81 32h6M91 32h1M17 33h1M23 33h1M69 33h1M80 33h2M86 33h2M91 33h1M17 34h1M23 34h1M69 34h1M79 34h2M87 34h1M92 34h1M17 35h1M23 35h1M69 35h1M79 35h1M87 35h1M92 35h1M17 36h1M23 36h1M69 36h1M77 36h2M87 36h2M92 36h1M17 37h1M23 37h1M69 37h1M76 37h2M88 37h1M92 37h1M17 38h1M23 38h1M69 38h1M76 38h1M88 38h1M92 38h1M17 39h1M23 39h1M69 39h1M76 39h1M88 39h1M92 39h1M17 40h1M23 40h1M69 40h1M76 40h1M88 40h1M92 40h1M17 41h1M23 41h1M69 41h1M76 41h1M87 41h2M92 41h1M17 42h1M23 42h1M69 42h1M76 42h1M87 42h1M92 42h1M17 43h1M23 43h1M69 43h1M76 43h1M87 43h1M92 43h1M17 44h1M23 44h1M69 44h1M76 44h1M86 44h2M92 44h1M17 45h1M23 45h1M69 45h1M75 45h2M86 45h1M91 45h2M17 46h1M23 46h1M69 46h1M75 46h1M86 46h1M91 46h1M17 47h1M23 47h1M69 47h1M75 47h1M85 47h2M91 47h1M17 48h1M23 48h1M69 48h1M75 48h1M84 48h2M90 48h1M17 49h1M23 49h1M69 49h1M75 49h1M84 49h1M90 49h1M17 50h1M23 50h1M69 50h1M75 50h1M82 50h2M89 50h1M17 51h1M23 51h1M69 51h1M75 51h1M81 51h2M89 51h1M17 52h1M23 52h1M69 52h1M74 52h2M80 52h1M88 52h1M17 53h1M23 53h1M69 53h1M74 53h1M79 53h1M87 53h1M17 54h1M23 54h1M69 54h1M74 54h1M77 54h2M86 54h1M17 55h1M23 55h1M69 55h1M74 55h4M85 55h1M17 56h1M23 56h1M69 56h1M74 56h2M84 56h1M17 57h1M23 57h1M69 57h1M83 57h1M17 58h1M23 58h1M69 58h1M82 58h1M17 59h1M23 59h1M69 59h1M81 59h1M17 60h1M23 60h1M69 60h1M79 60h2M17 61h1M23 61h1M69 61h1M77 61h2M17 62h1M23 62h1M69 62h1M76 62h1M17 63h1M23 63h1M68 63h2M75 63h1M17 64h1M23 64h1M68 64h1M74 64h1M17 65h1M23 65h1M68 65h1M74 65h1M17 66h1M23 66h1M68 66h1M74 66h1M17 67h1M23 67h1M68 67h1M74 67h1M17 68h1M23 68h1M68 68h1M74 68h1M17 69h1M23 69h1M68 69h1M74 69h1M17 70h1M23 70h1M68 70h1M74 70h1M17 71h1M23 71h1M68 71h1M73 71h2M17 72h2M24 72h1M67 72h1M73 72h1M18 73h2M25 73h1M66 73h1M73 73h1M19 74h1M26 74h40M73 74h1M19 75h2M72 75h1M20 76h2M72 76h1M21 77h2M71 77h1M22 78h3M69 78h2M24 79h45M5 80h84M5 81h1M88 81h1M5 82h1M88 82h1M5 83h1M88 83h1M5 84h1M87 84h2M6 85h1M87 85h1M7 86h2M84 86h3M9 87h3M80 87h5M12 88h68"
      />
      <Path
        stroke="#752438"
        d="M19 24h4M18 25h5M18 26h4M18 27h3M18 28h3M18 29h2M18 30h2M18 31h2M18 32h1M18 33h1M88 42h1M88 43h1M87 45h1M87 46h1M85 49h1M84 50h2M83 51h2M81 52h3M80 53h2M18 54h1M79 54h2M18 55h2M78 55h2M18 56h2M76 56h3M18 57h2M18 58h2M18 59h2M18 60h2M18 61h2M18 62h2M18 63h2M18 64h2M18 65h2M18 66h2M18 67h2M18 68h2M18 69h2M18 70h2M19 71h1M20 72h1M20 73h2M72 73h1M21 74h2M70 74h2M22 75h3M68 75h4M22 76h5M66 76h5M23 77h46M25 78h44M6 82h1M6 83h2M85 83h3M6 84h4M83 84h4M7 85h7M81 85h6M9 86h10M79 86h5M12 87h9M78 87h2"
      />
      <Path
        stroke="#cf573c"
        d="M73 24h3M71 25h6M71 26h6M71 27h6M71 28h6M83 28h5M72 29h5M81 29h4M86 29h3M73 30h4M79 30h3M88 30h2M74 31h3M78 31h2M89 31h1M74 32h5M89 32h2M74 33h3M90 33h1M74 34h3M90 34h2M74 35h3M91 35h1M74 36h3M91 36h1M74 37h2M91 37h1M74 38h2M91 38h1M74 39h2M91 39h1M74 40h2M91 40h1M74 41h2M91 41h1M74 42h2M91 42h1M74 43h2M91 43h1M74 44h2M90 44h2M74 45h1M90 45h1M74 46h1M90 46h1M89 47h2M89 48h1M88 49h2M88 50h1M87 51h2M86 52h2M85 53h2M84 54h2M83 55h2M82 56h2M81 57h2M80 58h2M79 59h2M77 60h2M75 61h2M74 62h2M74 63h1"
      />
      <Path
        stroke="#a53030"
        d="M23 25h48M22 26h49M21 27h50M21 28h4M69 28h2M20 29h5M70 29h2M85 29h1M20 30h4M70 30h3M82 30h6M20 31h3M70 31h4M80 31h9M19 32h4M70 32h4M79 32h2M87 32h2M19 33h4M70 33h4M77 33h3M88 33h2M18 34h5M70 34h4M77 34h2M88 34h2M18 35h5M70 35h4M77 35h2M88 35h3M18 36h5M70 36h4M89 36h2M18 37h5M70 37h4M89 37h2M18 38h5M70 38h4M89 38h2M18 39h5M70 39h4M89 39h2M18 40h5M70 40h4M89 40h2M18 41h5M70 41h4M89 41h2M18 42h5M70 42h4M89 42h2M18 43h5M70 43h4M89 43h2M18 44h5M70 44h4M88 44h2M18 45h5M70 45h4M88 45h2M18 46h5M70 46h4M88 46h2M18 47h5M70 47h5M87 47h2M18 48h5M70 48h5M87 48h2M18 49h5M70 49h5M86 49h2M18 50h5M70 50h5M86 50h2M18 51h5M70 51h5M85 51h2M18 52h5M70 52h4M84 52h2M18 53h5M70 53h4M82 53h3M19 54h4M70 54h4M81 54h3M20 55h3M70 55h4M80 55h3M20 56h3M70 56h4M79 56h3M20 57h3M70 57h11M20 58h3M70 58h10M20 59h3M70 59h9M20 60h3M70 60h7M20 61h3M70 61h5M20 62h3M70 62h4M20 63h3M70 63h4M20 64h3M69 64h5M20 65h3M69 65h5M20 66h3M69 66h5M20 67h3M69 67h5M20 68h3M69 68h5M20 69h3M69 69h5M20 70h3M69 70h5M20 71h3M69 71h4M21 72h3M68 72h5M22 73h3M67 73h5M23 74h3M66 74h4M25 75h43M27 76h39M6 81h82M7 82h81M8 83h77M10 84h73M14 85h67M19 86h60M21 87h57"
      />

      <Path stroke="#411d31" d="M86 48h1M18 71h1M19 72h1M20 74h1M72 74h1M21 75h1M71 76h1M69 77h2" />
      {/* fill */}
      <AnimatedPath stroke="#411d31" animatedProps={animatedProps} />
    </Svg>
  );
};

export default CoffeeCupSvg;
